(()=>{var e={d:(t,a)=>{for(var i in a)e.o(a,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:a[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};(()=>{"use strict";e.r(t),e.d(t,{onRpcRequest:()=>n,onTransaction:()=>s});class a{async analyzeTransaction(e){const t=this.extractFeatures(e);return this.assessRisk(t)}extractFeatures(e){var t,a,i,s,n;return{value:(null===(t=e.value)||void 0===t?void 0:t.toString())||"0",gasPrice:(null===(a=e.gasPrice)||void 0===a?void 0:a.toString())||"0",gasLimit:(null===(i=e.gas)||void 0===i?void 0:i.toString())||"0",contractAddress:e.to||"",methodSignature:this.extractMethodSignature((null===(s=e.data)||void 0===s?void 0:s.toString())||""),inputData:(null===(n=e.data)||void 0===n?void 0:n.toString())||""}}extractMethodSignature(e){return e.length>=10?e.slice(0,10):""}assessRisk(e){const t=[];let a=0;parseInt(e.value)/1e18>10&&(t.push("High value transaction"),a+=30),this.isKnownMethodSignature(e.methodSignature)||(t.push("Unknown method signature"),a+=20);return parseInt(e.gasPrice)>1e11&&(t.push("High gas price"),a+=10),{riskScore:a,riskLevel:this.calculateRiskLevel(a),riskFactors:t}}isKnownMethodSignature(e){return["0xa9059cbb","0x095ea7b3","0x23b872dd"].includes(e)}calculateRiskLevel(e){return e<20?"LOW":e<40?"MEDIUM":e<60?"HIGH":"CRITICAL"}}const i=new class{transactionModel;constructor(){this.transactionModel=new a}async analyzeTransaction(e){const t=await this.transactionModel.analyzeTransaction(e),a=await this.performSecurityChecks(e);return{riskAssessment:t,securityChecks:a,recommendations:this.generateRecommendations(t,a),timestamp:Date.now()}}async performSecurityChecks(e){const t=[];return t.push({name:"Contract Verification",passed:await this.isContractVerified(e.to||""),details:"Checks if the target contract is verified on block explorer"}),t.push({name:"Phishing Detection",passed:await this.checkPhishingDatabase(e.to||""),details:"Checks if the contract address is in known phishing databases"}),t.push({name:"Smart Contract Security",passed:await this.checkSmartContractSecurity(e.to||""),details:"Analyzes smart contract for common vulnerabilities"}),t}generateRecommendations(e,t){const a=[];return"HIGH"!==e.riskLevel&&"CRITICAL"!==e.riskLevel||a.push("⚠️ Yüksek riskli işlem! İşlemi onaylamadan önce dikkatli kontrol edin."),t.forEach((e=>{if(!e.passed)switch(e.name){case"Contract Verification":a.push("📋 Doğrulanmamış kontrat! Kaynak kodunu kontrol edin.");break;case"Phishing Detection":a.push("🚫 Bu adres potansiyel olarak tehlikeli olabilir!");break;case"Smart Contract Security":a.push("🔒 Akıllı kontrat güvenlik riskleri tespit edildi.")}})),a}async isContractVerified(e){return!0}async checkPhishingDatabase(e){return!0}async checkSmartContractSecurity(e){return!0}},s=async({transaction:e})=>{const t=await i.analyzeTransaction(e);return{content:{type:"panel",children:[{type:"heading",value:"🛡️ MetaGuard Güvenlik Analizi"},{type:"text",value:`Risk Seviyesi: ${t.riskAssessment.riskLevel}`},{type:"text",value:`Risk Skoru: ${t.riskAssessment.riskScore}/100`},{type:"divider"},{type:"heading",value:"🔍 Risk Faktörleri:"},...t.riskAssessment.riskFactors.map((e=>({type:"text",value:`• ${e}`}))),{type:"divider"},{type:"heading",value:"✅ Güvenlik Kontrolleri:"},...t.securityChecks.map((e=>({type:"text",value:`${e.passed?"✅":"❌"} ${e.name}: ${e.details}`}))),{type:"divider"},{type:"heading",value:"💡 Öneriler:"},...t.recommendations.map((e=>({type:"text",value:e})))]}}},n=async({request:e})=>{if("analyze"===e.method)return!0;throw new Error("Method not found.")}})(),module.exports=t})();